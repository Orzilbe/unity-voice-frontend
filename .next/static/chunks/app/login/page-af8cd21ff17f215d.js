(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4520],{9690:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>d});var r=t(95155),a=t(12115),o=t(35695),n=t(66681),l=t(24363),i=t(45604),c=t(71723);function d(){let[e,s]=(0,a.useState)({email:"",password:""}),[t,d]=(0,a.useState)(!1),[u,m]=(0,a.useState)(!0),[h,g]=(0,a.useState)(""),[x,f]=(0,a.useState)(!1),[p,y]=(0,a.useState)(!1),v=(0,o.useRouter)(),{login:w,isAuthenticated:j}=(0,n.A)();console.log("\uD83D\uDD0D Login page render - isAuthenticated:",j),(0,a.useEffect)(()=>{j&&(console.log("\uD83D\uDE80 User already authenticated on mount, redirecting..."),v.push("/topics"))},[]),(0,a.useEffect)(()=>{y(!0)},[]),(0,a.useEffect)(()=>{console.log("\uD83D\uDD04 Login page useEffect - isAuthenticated:",j,"isMounted:",p),j&&p&&(console.log("✅ User already authenticated, redirecting to topics..."),v.push("/topics"))},[j,p,v]);let N=e=>{let{name:t,value:r}=e.target;s(e=>({...e,[t]:r}))},b=async s=>{if(s.preventDefault(),f(!0),g(""),!e.email.includes("@")){g("Please enter a valid email address"),f(!1);return}if(e.password.length<8){g("Password must be at least 8 characters long"),f(!1);return}try{console.log("\uD83D\uDD10 Attempting login...");let s=await w(e.email,e.password,u);s.success?(console.log("✅ Login successful!"),console.log("\uD83D\uDE80 Navigating to topics page..."),setTimeout(()=>{console.log("\uD83D\uDD04 Attempting navigation now..."),v.push("/topics"),setTimeout(()=>{"/login"===window.location.pathname&&(console.log("⚠️ router.push failed, using window.location..."),window.location.href="/topics")},2e3)},100)):(g(s.message||"Login failed"),console.log("Login details:",s.details||"No additional details available"))}catch(e){g("An unexpected error occurred"),console.error("Login error:",e)}finally{f(!1)}};return p?(0,r.jsxs)("div",{className:"flex flex-col justify-center items-center min-h-screen bg-gradient-to-br from-blue-50 to-teal-50 font-sans",children:[(0,r.jsx)("div",{className:"absolute top-0 left-0 w-full h-32 bg-teal-500 rounded-b-[40%]"}),(0,r.jsxs)("div",{className:"relative z-10 w-full max-w-6xl px-6 py-12 flex flex-col lg:flex-row lg:items-center lg:justify-between",children:[(0,r.jsx)("div",{className:"lg:w-1/2 lg:pr-12 mb-8 lg:mb-0",children:(0,r.jsxs)("div",{className:"hidden lg:block",children:[(0,r.jsx)(l.A,{title:"Welcome Back"}),(0,r.jsxs)("div",{className:"mt-6 text-gray-600",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-teal-700 mb-4",children:"Continue Your English Journey"}),(0,r.jsx)("p",{className:"mb-3",children:"Log in to access your personalized advocacy English learning materials."}),(0,r.jsxs)("div",{className:"mt-8 space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("svg",{className:"h-6 w-6 text-teal-500 mr-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),(0,r.jsx)("span",{children:"Access your custom learning path"})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("svg",{className:"h-6 w-6 text-teal-500 mr-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),(0,r.jsx)("span",{children:"Track your progress and achievements"})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("svg",{className:"h-6 w-6 text-teal-500 mr-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),(0,r.jsx)("span",{children:"Connect with mentors and fellow learners"})]})]})]})]})}),(0,r.jsxs)("div",{className:"lg:w-1/2",children:[(0,r.jsxs)("div",{className:"block lg:hidden text-center mb-6",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-800",children:"Welcome Back"}),(0,r.jsx)("div",{className:"mt-2 w-16 h-1 bg-teal-500 mx-auto rounded-full"})]}),(0,r.jsxs)(c.A,{children:[h&&(0,r.jsx)("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 px-4 py-3 rounded-md mb-4 shadow-md",children:(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("div",{className:"py-1",children:(0,r.jsx)("svg",{className:"h-6 w-6 text-red-500 mr-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,r.jsx)("div",{children:(0,r.jsx)("p",{className:"text-sm",children:h})})]})}),(0,r.jsxs)("form",{onSubmit:b,className:"space-y-5",children:[(0,r.jsx)(i.A,{label:"Email",type:"email",name:"email",value:e.email,onChange:N,icon:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),(0,r.jsxs)("div",{className:"relative rounded-md shadow-sm",children:[(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),(0,r.jsx)("input",{id:"password",name:"password",type:t?"text":"password",value:e.password,onChange:N,placeholder:"Enter your password",className:"pl-10 w-full px-3 py-2 border rounded-md border-gray-300 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-teal-500 text-gray-700"}),(0,r.jsx)("button",{type:"button",onClick:()=>d(!t),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500","aria-label":t?"Hide password":"Show password",children:t?(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{id:"remember-me",name:"remember-me",type:"checkbox",checked:u,onChange:e=>m(e.target.checked),className:"h-4 w-4 text-teal-600 focus:ring-teal-500 border-gray-300 rounded"}),(0,r.jsx)("label",{htmlFor:"remember-me",className:"ml-2 block text-sm text-gray-700",children:"Remember me"})]}),(0,r.jsx)("div",{className:"text-sm",children:(0,r.jsx)("a",{href:"#",className:"font-medium text-teal-600 hover:text-teal-500",children:"Forgot your password?"})})]}),(0,r.jsx)("div",{className:"pt-4",children:(0,r.jsx)("button",{type:"submit",className:"w-full py-3 px-4 bg-teal-600 text-white font-medium rounded-lg shadow-md hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2 transition-colors duration-200 transform hover:scale-105",disabled:x,children:x?(0,r.jsxs)("div",{className:"flex items-center justify-center",children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Logging in..."]}):"Login"})}),(0,r.jsxs)("div",{className:"text-center text-sm text-gray-600 mt-4",children:["Don't have an account? ",(0,r.jsx)("a",{href:"/signup",className:"font-medium text-teal-600 hover:text-teal-500",children:"Sign up"})]})]})]})]})]})]}):(0,r.jsx)("div",{className:"flex justify-center items-center min-h-screen bg-gradient-to-br from-blue-50 to-teal-50 font-sans",children:(0,r.jsx)("div",{className:"text-teal-600 text-xl animate-pulse",children:"טוען..."})})}},24363:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});var r=t(95155);function a(e){let{title:s="Unity Voice",subtitle:t="Learn English, Share Israel's Story!",titleClass:a="text-6xl text-orange-500",subtitleClass:o="text-xl text-gray-700 mt-4"}=e;return(0,r.jsxs)("div",{className:"text-center mb-8",children:[(0,r.jsx)("h1",{className:"".concat(a," font-bold"),children:s}),t&&(0,r.jsx)("p",{className:"".concat(o),children:t})]})}},35695:(e,s,t)=>{"use strict";var r=t(18999);t.o(r,"useParams")&&t.d(s,{useParams:function(){return r.useParams}}),t.o(r,"usePathname")&&t.d(s,{usePathname:function(){return r.usePathname}}),t.o(r,"useRouter")&&t.d(s,{useRouter:function(){return r.useRouter}}),t.o(r,"useSearchParams")&&t.d(s,{useSearchParams:function(){return r.useSearchParams}})},41008:(e,s,t)=>{"use strict";t.d(s,{Av:()=>n,Ly:()=>m,bZ:()=>l,e$:()=>u,kV:()=>c,l6:()=>d,zG:()=>i});let r=t(49509).env.NEXT_PUBLIC_API_URL;async function a(e){let s=e.headers.get("content-type");if(console.log("Response status: ".concat(e.status,", Content-Type: ").concat(s)),s&&s.includes("application/json"))try{let s=await e.json();if(!e.ok){let t={status:e.status,statusText:e.statusText,message:s.message||s.error||"API request failed",responseData:s,url:e.url};throw console.error("API Error (JSON):",t),t}return s}catch(s){if(!e.ok){let t={status:e.status,statusText:e.statusText,message:"Failed to parse JSON response: ".concat(s),responseData:null,url:e.url};throw console.error("API Error (JSON Parse Failed):",t),t}throw s}try{let s=await e.text();if(console.log("Response text (first 200 chars): ".concat(s.substring(0,200))),!e.ok){let t={status:e.status,statusText:e.statusText,message:s||"API request failed",responseData:s,url:e.url};throw console.error("API Error (Text):",t),t}return s}catch(t){let s={status:e.status,statusText:e.statusText,message:"Failed to read response: ".concat(t),responseData:null,url:e.url};throw console.error("API Error (Text Read Failed):",s),s}}async function o(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t={"Content-Type":"application/json",...s.headers},o="".concat(r).concat(e);console.log("Making API call to: ".concat(o));try{let e=await fetch(o,{...s,headers:t,credentials:"include"});return await a(e)}catch(s){throw console.error("API call failed for ".concat(e,":"),{url:o,error:s,errorMessage:s instanceof Error?s.message:"Unknown error",errorStack:s instanceof Error?s.stack:void 0,headers:t}),s&&"object"==typeof s&&(s.endpoint=e,s.fullUrl=o),s}}async function n(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o(e,s)}async function l(){return o("/health")}let i={login:async e=>o("/auth/login",{method:"POST",body:JSON.stringify(e)}),register:async e=>o("/auth/register",{method:"POST",body:JSON.stringify(e)}),validate:async()=>o("/auth/validate",{method:"POST",body:JSON.stringify({})}),logout:async()=>o("/auth/logout",{method:"POST"})},c={getProfile:async()=>o("/user/profile"),updateProfile:async e=>o("/user/profile",{method:"PUT",body:JSON.stringify(e)}),getData:async()=>o("/user/data")},d={getAll:async()=>o("/topics"),getById:async e=>o("/topics/".concat(e)),getUserProgress:async()=>o("/topics/progress")},u={create:async e=>o("/tasks",{method:"POST",body:JSON.stringify(e)}),getById:async e=>o("/tasks/".concat(e)),update:async(e,s)=>o("/tasks/".concat(e),{method:"PUT",body:JSON.stringify(s)}),getUserTasks:async e=>o("/tasks/user/".concat(e))},m={getByTopicAndLevel:async(e,s)=>{try{console.log('\uD83D\uDE80 Fetching flashcards: topic="'.concat(e,'", level="').concat(s,'"'));let t=await o("/flashcards/".concat(encodeURIComponent(e),"/").concat(s));if(t&&t.success)return console.log("✅ Received ".concat(t.data.length," unlearned flashcards")),t.data;if(Array.isArray(t))return console.log("✅ Received ".concat(t.length," unlearned flashcards (direct array)")),t;throw console.error("❌ Unexpected response format:",t),Error("Invalid response format from flashcards API")}catch(e){throw console.error("❌ Error fetching flashcards:",e),e}},create:async e=>o("/flashcards",{method:"POST",body:JSON.stringify(e)}),markAsLearned:async(e,s,t)=>o("/flashcards/mark-learned",{method:"POST",body:JSON.stringify({WordId:e,TaskId:s,TopicName:t})})}},43110:(e,s,t)=>{Promise.resolve().then(t.bind(t,9690))},45604:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});var r=t(95155);t(12115);let a=e=>{let{label:s,type:t,name:a,value:o,onChange:n,error:l,placeholder:i,icon:c}=e;return(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{htmlFor:a,className:"block text-sm font-medium text-gray-700",children:s}),(0,r.jsxs)("div",{className:"relative rounded-md shadow-sm",children:[c&&(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c}),(0,r.jsx)("input",{id:a,name:a,type:t,value:o,onChange:n,placeholder:i||"Enter your ".concat(s.toLowerCase()),className:"".concat(c?"pl-10":"pl-3"," w-full px-3 py-2 border rounded-md ").concat(l?"border-red-500":"border-gray-300"," focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-colors duration-200 text-gray-700")})]}),l&&(0,r.jsx)("p",{className:"text-red-500 text-xs",children:l})]})}},66681:(e,s,t)=>{"use strict";t.d(s,{A:()=>i});var r=t(12115),a=t(41008);let o=[],n={isAuthenticated:!1,isLoading:!0,user:null,error:null,isInitialized:!1},l=e=>{n=e,o.forEach(s=>s(e))},i=()=>{let[e,s]=(0,r.useState)(n);(0,r.useEffect)(()=>{let e=e=>{s(e)};return o.push(e),()=>{o=o.filter(s=>s!==e)}},[]);let t=(0,r.useCallback)(e=>{s(e),l(e)},[]),i=(0,r.useCallback)(async()=>{console.log("\uD83D\uDD0D Starting auth validation...");try{let e=await a.zG.validate();if(console.log("\uD83D\uDCE1 Validation response:",e),!e.valid&&!e.success)return localStorage.removeItem("user"),t({isAuthenticated:!1,isLoading:!1,user:null,error:e.message||"Authentication failed",isInitialized:!0}),!1;{let s=e.user;if(!s||!s.role&&!s.UserRole){let e=localStorage.getItem("user");if(e)try{s={...JSON.parse(e),...s}}catch(e){console.error("Error parsing stored user data:",e)}}return s&&(s={...s,role:s.role||s.UserRole||"user",UserRole:s.UserRole||s.role||"user"}),t({isAuthenticated:!0,isLoading:!1,user:s,error:null,isInitialized:!0}),!0}}catch(s){console.error("Auth validation error:",s);let e=localStorage.getItem("user");if(e)try{let s=JSON.parse(e);return t({isAuthenticated:!0,isLoading:!1,user:s,error:null,isInitialized:!0}),!0}catch(e){console.error("Error parsing stored user data:",e)}return localStorage.removeItem("user"),t({isAuthenticated:!1,isLoading:!1,user:null,error:s instanceof Error?s.message:"Authentication error",isInitialized:!0}),!1}},[t]);(0,r.useEffect)(()=>{i()},[i]);let c=async function(s,r){arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{console.log("\uD83D\uDD10 Starting login process..."),t({...e,isLoading:!0});let o=await a.zG.login({email:s,password:r});if(console.log("\uD83D\uDCE1 Login response:",o),!o.success)return t({isAuthenticated:!1,isLoading:!1,user:null,error:o.message||"Login failed",isInitialized:!0}),{success:!1,message:o.message||"Login failed"};{let e=o.user||{email:s},r={...e,role:(null==e?void 0:e.role)||(null==e?void 0:e.UserRole)||"user",UserRole:(null==e?void 0:e.UserRole)||(null==e?void 0:e.role)||"user"};return localStorage.setItem("user",JSON.stringify(r)),t({isAuthenticated:!0,isLoading:!1,user:r,error:null,isInitialized:!0}),{success:!0}}}catch(s){if(console.error("❌ Login error:",s),s.responseData){let e=s.responseData.message||s.message||"Login failed";return console.log("API Error details:",s.responseData),t({isAuthenticated:!1,isLoading:!1,user:null,error:e,isInitialized:!0}),{success:!1,message:e,details:s.responseData.details}}let e=s instanceof Error?s.message:"An unexpected error occurred";return t({isAuthenticated:!1,isLoading:!1,user:null,error:e,isInitialized:!0}),{success:!1,message:e}}},d=async()=>{console.log("\uD83D\uDC4B Logging out...");try{await a.zG.logout()}catch(e){console.error("Logout API call failed:",e)}localStorage.removeItem("user"),t({isAuthenticated:!1,isLoading:!1,user:null,error:null,isInitialized:!0})};return{...e,login:c,logout:d,validateAuth:i}}},71723:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});var r=t(95155);t(12115);let a=e=>{let{children:s}=e;return(0,r.jsx)("div",{className:"bg-white p-8 rounded-xl shadow-xl border border-gray-100 w-full max-w-md transform transition-all duration-300 hover:shadow-2xl",children:s})}}},e=>{var s=s=>e(e.s=s);e.O(0,[8441,1684,7358],()=>s(43110)),_N_E=e.O()}]);