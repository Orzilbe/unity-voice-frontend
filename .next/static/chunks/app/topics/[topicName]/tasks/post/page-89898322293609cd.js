(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3330],{7564:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>x});var s=a(95155),r=a(11518),o=a.n(r),n=a(12115),l=a(35695),i=a(29911),c=a(79323),d=a(66681),m=a(13105);function x(){let{isAuthenticated:e,isLoading:t}=(0,d.A)(),a=(0,l.useRouter)(),r=(0,l.useParams)(),x=(0,l.useSearchParams)(),f=null==r?void 0:r.topicName,h=(null==x?void 0:x.get("level"))||"1",p=null==x?void 0:x.get("taskId"),[j,g]=(0,n.useState)(""),[b,v]=(0,n.useState)(""),[y,N]=(0,n.useState)(!0),[w,k]=(0,n.useState)(!1),[S,C]=(0,n.useState)(!1),[O,D]=(0,n.useState)(null),[P,E]=(0,n.useState)([]),[F,I]=(0,n.useState)(null),[R,T]=(0,n.useState)({likes:Math.floor(50*Math.random())+10,comments:0,shares:Math.floor(10*Math.random())+5}),[A,_]=(0,n.useState)(!1),[W,z]=(0,n.useState)(null),[U,q]=(0,n.useState)("");(0,n.useEffect)(()=>{t||e||a.push("/login")},[e,t,a]);let L=e=>e.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),M="".concat(L(f)," - Social Post Task"),B=(0,n.useCallback)(async()=>{if(!e||!f||!p)return;let t=(0,c.c4)();if(!t)return void D("Authentication required");try{N(!0),D(null),console.log("\uD83C\uDFAF Fetching post data for task: ".concat(p));let e=await (0,m.v)("/api/posts/".concat(encodeURIComponent(p)),{headers:{Authorization:"Bearer ".concat(t)}});if(e.ok){let t=await e.json();if(console.log("\uD83D\uDCC4 Post data received:",t),t.success&&t.postData){var a,s;g(t.postData.PostContent||""),E(t.postData.RequiredWords||[]),z(t.postData.Picture),q((null==(a=t.meta)?void 0:a.source)||"unknown"),console.log("✅ Post loaded successfully (source: ".concat(null==(s=t.meta)?void 0:s.source,")"))}else throw Error("Invalid response format")}else{let t=await e.json();throw Error(t.error||"Failed to load post")}}catch(e){console.error("❌ Error loading post:",e),D("Failed to load social post. Please try again."),g(function(e){let t=e.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ");return"\uD83C\uDDEE\uD83C\uDDF1 Let's explore ".concat(t,"! \n\nThis is an important topic that affects many aspects of Israeli society and culture. There are fascinating developments happening in this area that impact our daily lives.\n\nWhat are your thoughts on this subject? How do you think recent changes in ").concat(t.toLowerCase()," have influenced Israeli society? \n\nI'd love to hear your perspective on this! \uD83D\uDCAD")}(f)),E(function(e){let t=e.toLowerCase();if(t.includes("diplomacy"))return["diplomacy","peace","negotiation","agreement","international"];if(t.includes("economy"))return["startup","innovation","entrepreneur","investment","technology"];if(t.includes("innovation"))return["technology","startup","innovation","research","development"];if(t.includes("history"))return["heritage","tradition","ancient","archaeological","civilization"];if(t.includes("holocaust"))return["remembrance","survivor","memorial","testimony","resilience"];else if(t.includes("iron")||t.includes("sword"))return["security","defense","protection","resilience","strength"];else if(t.includes("society"))return["diversity","culture","community","tradition","integration"];else if(t.includes("environment"))return["environment","sustainability","renewable","green","conservation"];return["culture","heritage","history","innovation","community"]}(f)),z(u(f)),q("fallback")}finally{N(!1)}},[e,f,p]);(0,n.useEffect)(()=>{B()},[B]),(0,n.useEffect)(()=>{p&&sessionStorage.setItem("task_start_".concat(p),Date.now().toString())},[p]);let G=async()=>{if(!p)return;let e=(0,c.c4)();if(e)try{C(!0),console.log("\uD83D\uDD04 Regenerating post...");let t=await (0,m.v)("/api/posts/regenerate/".concat(encodeURIComponent(p)),{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(t.ok){let e=await t.json();console.log("\uD83C\uDD95 New post generated:",e),e.success&&e.postData&&(g(e.postData.PostContent||""),E(e.postData.RequiredWords||[]),z(e.postData.Picture),q("regenerated"),v(""),I(null))}else console.error("Failed to regenerate post")}catch(e){console.error("Error regenerating post:",e)}finally{C(!1)}},H=async()=>{if(b.trim()&&p){k(!0);try{let e=(0,c.c4)(),t=parseInt(sessionStorage.getItem("task_start_".concat(p))||"0"),a=t?Math.floor((Date.now()-t)/1e3):0;console.log("\uD83D\uDCAC Submitting comment...");let s=await (0,m.v)("/api/comments/submit",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({taskId:p,commentContent:b.trim(),requiredWords:P,postContent:j,durationTask:a})});if(s.ok){let e=await s.json();console.log("✅ Comment submitted successfully:",e),e.success&&e.feedback&&(I({totalScore:e.feedback.totalScore,clarityScore:e.feedback.clarityScore,grammarScore:e.feedback.grammarScore,vocabularyScore:e.feedback.vocabularyScore,contentRelevanceScore:e.feedback.contentRelevanceScore,clarityFeedback:e.feedback.clarityFeedback,grammarFeedback:e.feedback.grammarFeedback,vocabularyFeedback:e.feedback.vocabularyFeedback,contentRelevanceFeedback:e.feedback.contentRelevanceFeedback,overallFeedback:e.feedback.overallFeedback,wordUsage:e.feedback.wordUsage||[]}),T(e=>({...e,comments:e.comments+1})))}else{let e=await s.json();console.error("❌ Comment submission failed:",e),e.issues?alert("Please fix these issues:\n".concat(e.issues.join("\n"))):alert("Failed to submit comment. Please try again.")}}catch(e){console.error("❌ Error submitting comment:",e),alert("Failed to submit comment. Please check your connection.")}finally{k(!1)}}},J=async()=>{try{let e=(0,c.c4)();if(!e)throw Error("Authentication required");console.log("\uD83D\uDE80 Creating conversation task...");let t=await (0,m.v)("/api/tasks",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({TopicName:Q(f),Level:parseInt(h),TaskType:"conversation"})});if(t.ok){let e=await t.json();if(console.log("✅ Created conversation task:",e),e.TaskId)return void a.push("/topics/".concat(f,"/tasks/conversation?level=").concat(h,"&taskId=").concat(e.TaskId))}else console.error("Failed to create conversation task")}catch(e){console.error("Error creating conversation task:",e)}a.push("/topics/".concat(f,"/tasks/conversation?level=").concat(h))},Q=e=>e.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ");return t||y?(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-yellow-50 via-orange-50 to-red-50 p-6 flex justify-center items-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"inline-block w-16 h-16 border-4 border-orange-500 border-t-transparent rounded-full animate-spin mb-4"}),(0,s.jsx)("p",{className:"text-xl font-medium text-gray-700",children:"Loading post..."})]})}):O?(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-yellow-50 via-orange-50 to-red-50 p-6 flex justify-center items-center",children:(0,s.jsxs)("div",{className:"max-w-md w-full bg-white p-8 rounded-2xl shadow-xl text-center",children:[(0,s.jsx)("div",{className:"text-red-500 text-5xl mb-4",children:"❌"}),(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:O}),(0,s.jsx)("p",{className:"text-gray-600 mb-6",children:"We're having trouble loading the post. Let's try again."}),(0,s.jsx)("div",{className:"flex flex-col gap-4",children:(0,s.jsx)("button",{onClick:B,disabled:y,className:"px-6 py-3 bg-orange-500 text-white rounded-xl hover:bg-orange-600 transition-all duration-300 disabled:opacity-50",children:y?"Loading...":"Try Again"})})]})}):(0,s.jsxs)("div",{dir:"ltr",className:"jsx-a601612189e0457 min-h-screen bg-gradient-to-br from-yellow-50 via-orange-50 to-red-50 p-6 relative",children:[(0,s.jsx)(o(),{id:"a601612189e0457",children:'@import url("https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;600;700&display=swap");body{font-family:"Rubik",sans-serif}'}),(0,s.jsxs)("div",{className:"jsx-a601612189e0457 max-w-4xl mx-auto",children:[(0,s.jsxs)("div",{className:"jsx-a601612189e0457 flex justify-between items-center mb-6",children:[(0,s.jsx)("h1",{className:"jsx-a601612189e0457 text-3xl font-bold text-gray-800",children:M}),!F&&(0,s.jsxs)("button",{onClick:G,disabled:S,title:"Generate a new post",className:"jsx-a601612189e0457 flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors disabled:opacity-50",children:[(0,s.jsx)(i.Swo,{className:S?"animate-spin":""}),S?"Generating...":"New Post"]})]}),U&&(0,s.jsxs)("div",{className:"jsx-a601612189e0457 mb-4 text-sm text-gray-600",children:["Post source: ",(0,s.jsx)("span",{className:"jsx-a601612189e0457 font-medium capitalize",children:U})]}),(0,s.jsxs)("div",{className:"jsx-a601612189e0457 bg-white rounded-2xl shadow-xl p-8 mb-8",children:[(0,s.jsxs)("div",{className:"jsx-a601612189e0457 flex items-center mb-8",children:[(0,s.jsx)("div",{className:"jsx-a601612189e0457 w-12 h-12 bg-orange-100 rounded-full flex items-center justify-center text-xl",children:"\uD83D\uDC64"}),(0,s.jsxs)("div",{className:"jsx-a601612189e0457 ml-4",children:[(0,s.jsx)("h2",{className:"jsx-a601612189e0457 text-xl font-bold text-gray-900",children:"Israel Expert"}),(0,s.jsx)("p",{className:"jsx-a601612189e0457 text-gray-600 text-sm font-medium",children:"2 hours ago • \uD83C\uDF0D"})]})]}),(0,s.jsxs)("div",{className:"jsx-a601612189e0457 flex flex-col md:flex-row gap-8 mb-8",children:[(0,s.jsx)("div",{className:"jsx-a601612189e0457 prose text-gray-800 md:w-3/5",children:(0,s.jsx)("p",{className:"jsx-a601612189e0457 whitespace-pre-line",children:j})}),(0,s.jsx)("div",{className:"jsx-a601612189e0457 md:w-2/5",children:W&&(0,s.jsx)("img",{src:W,alt:"Post Image",onError:e=>{e.currentTarget.src=u(f)},className:"jsx-a601612189e0457 w-full rounded-lg object-cover h-64"})})]}),(0,s.jsxs)("div",{className:"jsx-a601612189e0457 flex items-center space-x-12 text-gray-600",children:[(0,s.jsxs)("button",{onClick:()=>{_(!A),T(e=>({...e,likes:e.likes+(A?-1:1)}))},className:"jsx-a601612189e0457 flex items-center space-x-2 hover:text-red-500 transition-colors",children:[(0,s.jsx)(i.Mbv,{className:A?"text-red-500":""}),(0,s.jsx)("span",{className:"jsx-a601612189e0457 ml-2",children:R.likes})]}),(0,s.jsxs)("div",{className:"jsx-a601612189e0457 flex items-center space-x-2",children:[(0,s.jsx)(i.j1Q,{}),(0,s.jsx)("span",{className:"jsx-a601612189e0457 ml-2",children:R.comments})]}),(0,s.jsxs)("button",{className:"jsx-a601612189e0457 flex items-center space-x-2 hover:text-blue-500 transition-colors",children:[(0,s.jsx)(i.Zzu,{}),(0,s.jsx)("span",{className:"jsx-a601612189e0457 ml-2",children:R.shares})]})]})]}),(0,s.jsxs)("div",{className:"jsx-a601612189e0457 bg-white rounded-2xl shadow-xl p-8 mb-8",children:[(0,s.jsxs)("div",{className:"jsx-a601612189e0457 flex items-center mb-6",children:[(0,s.jsx)(i.__w,{className:"text-orange-500 mr-3 text-xl"}),(0,s.jsx)("h3",{className:"jsx-a601612189e0457 text-xl font-bold text-gray-800",children:"Required Words:"})]}),(0,s.jsx)("div",{className:"jsx-a601612189e0457 flex flex-wrap gap-3",children:P.map(e=>(0,s.jsx)("span",{className:"jsx-a601612189e0457 px-6 py-3 bg-orange-500 text-white rounded-full text-base font-medium shadow-sm",children:e},e))})]}),(0,s.jsx)("div",{className:"jsx-a601612189e0457 bg-white rounded-2xl shadow-xl p-8",children:F?(0,s.jsxs)("div",{className:"jsx-a601612189e0457 space-y-6",children:[(0,s.jsxs)("div",{className:"jsx-a601612189e0457 bg-gray-50 p-6 rounded-lg",children:[(0,s.jsx)("h3",{className:"jsx-a601612189e0457 text-xl font-bold text-gray-800 mb-4",children:"Your Response:"}),(0,s.jsx)("p",{className:"jsx-a601612189e0457 text-gray-700 whitespace-pre-line",children:b})]}),(0,s.jsxs)("div",{className:"jsx-a601612189e0457 bg-orange-50 p-6 rounded-lg",children:[(0,s.jsxs)("div",{className:"jsx-a601612189e0457 flex justify-between items-center mb-6",children:[(0,s.jsx)("h3",{className:"jsx-a601612189e0457 text-xl font-bold text-gray-800",children:"Feedback:"}),(0,s.jsxs)("div",{className:"jsx-a601612189e0457 text-2xl font-bold text-orange-600",children:[F.totalScore,"/200 points"]})]}),(0,s.jsxs)("div",{className:"jsx-a601612189e0457 grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[(0,s.jsxs)("div",{className:"jsx-a601612189e0457",children:[(0,s.jsxs)("h4",{className:"jsx-a601612189e0457 font-bold text-gray-700",children:["Content Relevance (",F.contentRelevanceScore,"/100):"]}),(0,s.jsx)("p",{className:"jsx-a601612189e0457 text-gray-600",children:F.contentRelevanceFeedback})]}),(0,s.jsxs)("div",{className:"jsx-a601612189e0457",children:[(0,s.jsxs)("h4",{className:"jsx-a601612189e0457 font-bold text-gray-700",children:["Clarity (",F.clarityScore,"/100):"]}),(0,s.jsx)("p",{className:"jsx-a601612189e0457 text-gray-600",children:F.clarityFeedback})]}),(0,s.jsxs)("div",{className:"jsx-a601612189e0457",children:[(0,s.jsxs)("h4",{className:"jsx-a601612189e0457 font-bold text-gray-700",children:["Grammar (",F.grammarScore,"/100):"]}),(0,s.jsx)("p",{className:"jsx-a601612189e0457 text-gray-600",children:F.grammarFeedback})]}),(0,s.jsxs)("div",{className:"jsx-a601612189e0457",children:[(0,s.jsxs)("h4",{className:"jsx-a601612189e0457 font-bold text-gray-700",children:["Vocabulary (",F.vocabularyScore,"/100):"]}),(0,s.jsx)("p",{className:"jsx-a601612189e0457 text-gray-600",children:F.vocabularyFeedback})]})]}),(0,s.jsxs)("div",{className:"jsx-a601612189e0457 mb-6",children:[(0,s.jsx)("h4",{className:"jsx-a601612189e0457 font-bold text-gray-700 mb-2",children:"Required Words Usage:"}),(0,s.jsx)("ul",{className:"jsx-a601612189e0457 space-y-2",children:F.wordUsage.map(e=>{let{word:t,used:a,context:r}=e;return(0,s.jsxs)("li",{className:"jsx-a601612189e0457 flex items-start",children:[(0,s.jsx)("span",{className:"jsx-a601612189e0457 "+"mr-2 ".concat(a?"text-green-500":"text-red-500"),children:a?"✓":"✗"}),(0,s.jsxs)("div",{className:"jsx-a601612189e0457",children:[(0,s.jsxs)("span",{className:"jsx-a601612189e0457 font-medium",children:[t,":"]}),(0,s.jsx)("span",{className:"jsx-a601612189e0457 ml-2 text-gray-500",children:a?r:"Not found in your response"})]})]},t)})})]}),(0,s.jsx)("div",{className:"jsx-a601612189e0457 text-center p-4 bg-white rounded-lg mb-6",children:(0,s.jsx)("p",{className:"jsx-a601612189e0457 text-xl font-bold text-orange-600",children:F.overallFeedback})}),(0,s.jsx)("div",{className:"jsx-a601612189e0457 text-center",children:(0,s.jsx)("button",{onClick:J,className:"jsx-a601612189e0457 px-8 py-4 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-all duration-300 transform hover:-translate-y-1 shadow-md hover:shadow-lg text-lg",children:"Continue to Interactive Conversation \uD83C\uDF99️"})})]})]}):(0,s.jsxs)("div",{className:"jsx-a601612189e0457",children:[(0,s.jsx)("h3",{className:"jsx-a601612189e0457 text-xl font-bold text-gray-800 mb-6",children:"Write a response to this post:"}),(0,s.jsx)("p",{className:"jsx-a601612189e0457 text-gray-600 mb-4",children:"Use the required words in your response. We'll provide feedback on your comment."}),(0,s.jsx)("textarea",{value:b,onChange:e=>v(e.target.value),placeholder:"Write your response about ".concat(L(f)," using the required words..."),rows:6,disabled:w,className:"jsx-a601612189e0457 w-full p-4 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-orange-500 min-h-32 text-gray-900 mb-4"}),(0,s.jsx)("button",{onClick:H,disabled:w||!b.trim(),className:"jsx-a601612189e0457 w-full bg-orange-500 text-white py-3 rounded-lg hover:bg-orange-600 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:w?"Submitting...":"Submit Response"})]})})]})]})}function u(e){let t=e.toLowerCase();for(let[e,a]of Object.entries({diplomacy:"https://via.placeholder.com/800x600/2563eb/ffffff?text=Diplomacy",international:"https://via.placeholder.com/800x600/0ea5e9/ffffff?text=International+Relations",economy:"https://via.placeholder.com/800x600/059669/ffffff?text=Economy",entrepreneur:"https://via.placeholder.com/800x600/16a34a/ffffff?text=Entrepreneurship",innovation:"https://via.placeholder.com/800x600/7c3aed/ffffff?text=Innovation",technology:"https://via.placeholder.com/800x600/6366f1/ffffff?text=Technology",history:"https://via.placeholder.com/800x600/92400e/ffffff?text=History",heritage:"https://via.placeholder.com/800x600/a16207/ffffff?text=Heritage",holocaust:"https://via.placeholder.com/800x600/374151/ffffff?text=Memorial",revival:"https://via.placeholder.com/800x600/065f46/ffffff?text=Revival",iron:"https://via.placeholder.com/800x600/991b1b/ffffff?text=Defense",sword:"https://via.placeholder.com/800x600/991b1b/ffffff?text=Security",society:"https://via.placeholder.com/800x600/dc2626/ffffff?text=Society",multicultural:"https://via.placeholder.com/800x600/ea580c/ffffff?text=Multiculturalism",environment:"https://via.placeholder.com/800x600/16a34a/ffffff?text=Environment",sustainability:"https://via.placeholder.com/800x600/15803d/ffffff?text=Sustainability"}))if(t.includes(e))return a;return"https://via.placeholder.com/800x600/3b82f6/ffffff?text=Israeli+Culture"}},13105:(e,t,a)=>{"use strict";async function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return fetch(e,{credentials:"include",headers:{"Content-Type":"application/json",...t.headers||{}},...t})}a.d(t,{v:()=>s})},18404:(e,t,a)=>{Promise.resolve().then(a.bind(a,7564))},74436:(e,t,a)=>{"use strict";a.d(t,{k5:()=>d});var s=a(12115),r={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},o=s.createContext&&s.createContext(r),n=["attr","size","title"];function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e}).apply(this,arguments)}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,s)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach(function(t){var s,r,o;s=e,r=t,o=a[t],(r=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var s=a.call(e,t||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(r))in s?Object.defineProperty(s,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):s[r]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function d(e){return t=>s.createElement(m,l({attr:c({},e.attr)},t),function e(t){return t&&t.map((t,a)=>s.createElement(t.tag,c({key:a},t.attr),e(t.child)))}(e.child))}function m(e){var t=t=>{var a,{attr:r,size:o,title:i}=e,d=function(e,t){if(null==e)return{};var a,s,r=function(e,t){if(null==e)return{};var a={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;a[s]=e[s]}return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)a=o[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}(e,n),m=o||t.size||"1em";return t.className&&(a=t.className),e.className&&(a=(a?a+" ":"")+e.className),s.createElement("svg",l({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,d,{className:a,style:c(c({color:e.color||t.color},t.style),e.style),height:m,width:m,xmlns:"http://www.w3.org/2000/svg"}),i&&s.createElement("title",null,i),e.children)};return void 0!==o?s.createElement(o.Consumer,null,e=>t(e)):t(r)}},79323:(e,t,a)=>{"use strict";function s(){{let e=localStorage.getItem("token");if(e)return e;for(let e of document.cookie.split(";")){let[t,a]=e.trim().split("=");if("token"===t)return a}}return null}a.d(t,{c4:()=>s}),a(58801),a(41008),a(49509)}},e=>{var t=t=>e(e.s=t);e.O(0,[9268,6711,640,6681,8441,1684,7358],()=>t(18404)),_N_E=e.O()}]);