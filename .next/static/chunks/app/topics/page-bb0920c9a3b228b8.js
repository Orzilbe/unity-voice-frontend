(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6443],{21944:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>x});var a=t(95155),r=t(11518),o=t.n(r),l=t(12115),n=t(35695),i=t(66766),c=t(41008);let d=e=>{let{isVisible:s=!1,onToggle:t,showIcon:r=!0}=e,[o,n]=(0,l.useState)(null),[d,u]=(0,l.useState)(!0);(0,l.useEffect)(()=>{let e=async()=>{if(s){console.log("\uD83D\uDCCA UserProfile: Fetching user data..."),u(!0);try{let e=await (0,c.Av)("/user/profile");n({FirstName:e.FirstName||"",LastName:e.LastName||"",Email:e.Email||"",PhoneNumber:e.PhoneNumber||"",EnglishLevel:e.EnglishLevel||"Not Set",AgeRange:e.AgeRange||"",ProfilePicture:e.ProfilePicture||null,CreationDate:new Date(e.CreationDate),LastLogin:e.LastLogin?new Date(e.LastLogin):void 0,Score:e.Score||0}),u(!1),console.log("✅ UserProfile: User data loaded successfully")}catch(e){console.error("❌ UserProfile: Error fetching user data:",e),u(!1)}}};s&&e()},[s]);let f=()=>{console.log("\uD83D\uDD04 UserProfile: Toggle clicked"),t&&t()};return(0,a.jsxs)(a.Fragment,{children:[r&&(0,a.jsx)("div",{className:"absolute top-4 right-4",children:(0,a.jsx)("div",{className:"w-12 h-12 rounded-full bg-white shadow-lg flex items-center justify-center cursor-pointer hover:shadow-xl transform hover:scale-105 transition-all duration-300",onClick:f,children:(null==o?void 0:o.ProfilePicture)?(0,a.jsx)(i.default,{src:o.ProfilePicture,alt:"Profile",width:48,height:48,className:"w-full h-full rounded-full object-cover"}):(0,a.jsx)("span",{className:"text-2xl",children:"\uD83D\uDC64"})})}),s&&(0,a.jsxs)("div",{className:"absolute top-20 right-4 bg-white p-6 shadow-2xl rounded-2xl w-80 z-50 border border-gray-100 transform transition-all duration-300",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold mb-4 text-gray-800",children:"User Profile"}),d?(0,a.jsx)("div",{className:"flex justify-center items-center h-40",children:(0,a.jsx)("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"})}):o?(0,a.jsxs)("div",{className:"space-y-3 text-gray-800",children:[o.ProfilePicture&&(0,a.jsx)("div",{className:"flex justify-center mb-4",children:(0,a.jsx)(i.default,{src:o.ProfilePicture,alt:"Profile",width:96,height:96,className:"w-24 h-24 rounded-full object-cover border-4 border-gray-200"})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("p",{className:"flex justify-between",children:[(0,a.jsx)("strong",{children:"Name:"}),(0,a.jsx)("span",{children:(null==o?void 0:o.FirstName)||(null==o?void 0:o.LastName)?"".concat((null==o?void 0:o.FirstName)||""," ").concat((null==o?void 0:o.LastName)||"").trim():"Guest User"})]}),(0,a.jsxs)("p",{className:"flex justify-between",children:[(0,a.jsx)("strong",{children:"Email:"}),(0,a.jsx)("span",{className:"text-right",children:o.Email||"Not provided"})]}),(0,a.jsxs)("p",{className:"flex justify-between",children:[(0,a.jsx)("strong",{children:"Phone:"}),(0,a.jsx)("span",{children:o.PhoneNumber||"Not provided"})]}),(0,a.jsxs)("p",{className:"flex justify-between",children:[(0,a.jsx)("strong",{children:"English Level:"}),(0,a.jsx)("span",{children:o.EnglishLevel})]}),o.AgeRange&&(0,a.jsxs)("p",{className:"flex justify-between",children:[(0,a.jsx)("strong",{children:"Age Range:"}),(0,a.jsx)("span",{children:o.AgeRange})]}),(0,a.jsxs)("p",{className:"flex justify-between",children:[(0,a.jsx)("strong",{children:"Score:"}),(0,a.jsx)("span",{children:o.Score})]}),(0,a.jsxs)("p",{className:"flex justify-between",children:[(0,a.jsx)("strong",{children:"Member Since:"}),(0,a.jsx)("span",{children:o.CreationDate.toLocaleDateString()})]})]})]}):(0,a.jsx)("p",{className:"text-red-500",children:"Failed to load user data"}),(0,a.jsx)("div",{className:"mt-6 space-y-2",children:(0,a.jsx)("button",{className:"w-full py-2 bg-red-500 text-white rounded-xl hover:bg-red-600 transition-colors",onClick:f,children:"Close"})})]})]})},u=e=>{let{topic:s,userId:t,onError:r}=e,o=(0,n.useRouter)(),[i,d]=(0,l.useState)(!1),u=async e=>{if(e.preventDefault(),!i){d(!0);try{if(!t||""===t||"0"===t)throw Error("לא נמצא מזהה משתמש תקין - יש להתחבר מחדש");if(!localStorage.getItem("token"))throw Error("לא נמצא טוקן אימות - יש להתחבר מחדש");let e=s.TopicName.toLowerCase().replace(/\s+/g,"-");console.log("Creating task for topic: ".concat(s.TopicName,", userId: ").concat(t));try{let a=await c.e$.create({UserId:t,TopicName:s.TopicName,Level:1,TaskType:"flashcard"});if(!a||!a.TaskId)throw Error("לא התקבל מזהה משימה מהשרת");let r=a.TaskId;console.log("Task created successfully with ID:",r);let l="/topics/".concat(e,"/tasks/flashcard?level=1&taskId=").concat(r);console.log("Navigating to: ".concat(l)),o.push(l)}catch(e){var a;if(console.error("API Error details:",e),401===e.status)throw Error("פג תוקף ההתחברות - יש להתחבר מחדש");if(403===e.status)throw Error("אין הרשאה לבצע פעולה זו");if(400===e.status)throw Error(e.message||"נתונים לא תקינים");else if(null==(a=e.responseData)?void 0:a.message)throw Error(e.responseData.message);else throw Error("אירעה שגיאה בתקשורת עם השרת")}}catch(e){if(console.error("Error in topic selection:",e),e instanceof Error&&(e.message.includes("401")||e.message.includes("אימות")||e.message.includes("להתחבר")||e.message.includes("פג תוקף"))){console.log("Authentication error detected - redirecting to login"),o.push("/login");return}r&&r(e instanceof Error?e.message:"אירעה שגיאה בהתחלת פעילות. אנא נסה שוב.")}finally{d(!1)}}};return(0,a.jsx)("div",{onClick:u,className:"group bg-white p-6 rounded-2xl shadow-md hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1 cursor-pointer ".concat(i?"opacity-75":""),children:(0,a.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[i?(0,a.jsx)("div",{className:"w-10 h-10 border-4 border-orange-500 border-t-transparent rounded-full animate-spin"}):(0,a.jsx)("span",{className:"text-4xl group-hover:scale-110 transition-transform duration-300",children:s.Icon||"\uD83C\uDF1F"}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-800 mb-2 group-hover:text-orange-600 transition-colors",children:s.TopicName}),(0,a.jsx)("p",{className:"text-gray-500 text-sm",children:s.TopicHe})]})]})})};var f=t(66681),g=t(6874),h=t.n(g);function x(){let[e,s]=(0,l.useState)([]),[t,r]=(0,l.useState)({level:"",points:0,totalScore:0,completedTasks:0,activeSince:"",nextLevel:"",pointsToNextLevel:100}),[i,g]=(0,l.useState)(!1),[x,m]=(0,l.useState)(null),{isAuthenticated:p,isLoading:j,user:v,isInitialized:y}=(0,f.A)(),N=(0,n.useRouter)();console.log("\uD83D\uDD0D Topics page - Auth State:",{isAuthenticated:p,isLoading:j,isInitialized:y,user:v}),(0,l.useEffect)(()=>{(async()=>{if(console.log("\uD83D\uDD04 Topics page - Checking auth:",{isInitialized:y,isLoading:j,isAuthenticated:p}),!y||j||p)y&&!j&&p&&console.log("✅ User authenticated, staying on topics page");else{console.log("❌ User not authenticated, redirecting to login...");try{await N.push("/login"),console.log("✅ Navigation to login initiated")}catch(e){console.error("❌ Navigation failed:",e),window.location.href="/login"}}})()},[p,j,y,N]),(0,l.useEffect)(()=>{if(p){let e=async()=>{try{let e=await c.kV.getData();console.log("User data from API:",e),r({level:e.currentLevel||"Beginner",points:e.currentLevelPoints||0,totalScore:e.totalScore||e.Score||e.score||0,completedTasks:e.completedTasksCount||0,activeSince:e.CreationDate?new Date(e.CreationDate).toLocaleDateString():"Today",nextLevel:e.nextLevel||"Intermediate",pointsToNextLevel:e.pointsToNextLevel||100})}catch(e){console.error("Error fetching user data:",e),console.log("\uD83D\uDD04 Using mock user data as fallback"),r({level:"Beginner",points:150,totalScore:850,completedTasks:12,activeSince:new Date().toLocaleDateString(),nextLevel:"Intermediate",pointsToNextLevel:250})}};(async()=>{try{let e=await c.l6.getAll();console.log("Topics data:",e),s(e)}catch(e){console.error("Error fetching topics:",e),console.log("\uD83D\uDD04 Using mock topics data as fallback"),s([{TopicName:"Medical",TopicHe:"רפואה",Icon:"\uD83C\uDFE5"},{TopicName:"Legal",TopicHe:"משפטי",Icon:"⚖️"},{TopicName:"Social",TopicHe:"חברתי",Icon:"\uD83D\uDC65"},{TopicName:"Educational",TopicHe:"חינוכי",Icon:"\uD83D\uDCDA"},{TopicName:"Community",TopicHe:"קהילתי",Icon:"\uD83C\uDFD8️"},{TopicName:"Employment",TopicHe:"תעסוקה",Icon:"\uD83D\uDCBC"},{TopicName:"Healthcare",TopicHe:"בריאות",Icon:"\uD83D\uDC8A"},{TopicName:"Rights",TopicHe:"זכויות",Icon:"\uD83D\uDEE1️"}])}})(),e()}},[p]);let b=e=>{m(e),setTimeout(()=>m(null),5e3)};return!y||j?(0,a.jsx)("div",{className:"flex justify-center items-center min-h-screen bg-gradient-to-br from-blue-50 to-teal-50 font-sans",children:(0,a.jsxs)("div",{className:"flex flex-col items-center bg-white p-8 rounded-lg shadow-lg",children:[(0,a.jsx)("div",{className:"text-2xl text-teal-600 mb-4",children:y?"Loading Topics...":"Initializing..."}),(0,a.jsx)("div",{className:"w-16 h-16 border-t-4 border-b-4 border-teal-500 rounded-full animate-spin mb-4"}),(0,a.jsx)("div",{className:"text-sm text-gray-600 text-center",children:y?(0,a.jsx)("p",{children:"Fetching your personalized topics..."}):(0,a.jsx)("p",{children:"Setting up your session..."})}),(0,a.jsxs)("div",{className:"mt-4 text-xs text-gray-500",children:["Status: ",y?"Loading Data":"Initializing Auth"]})]})}):p?(console.log("✅ Topics page: Rendering content for authenticated user"),(0,a.jsxs)("div",{className:"jsx-26af8af8a308f6d6 min-h-screen bg-gradient-to-br from-yellow-50 via-orange-50 to-red-50 p-6 relative",children:[(0,a.jsx)(o(),{id:"26af8af8a308f6d6",children:'@import url("https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap");body{font-family:"Poppins",sans-serif}'}),(0,a.jsx)(d,{isVisible:i,onToggle:()=>g(!i),showIcon:!0}),(0,a.jsxs)("div",{className:"jsx-26af8af8a308f6d6 max-w-7xl mx-auto",children:[(0,a.jsx)("h1",{className:"jsx-26af8af8a308f6d6 text-5xl font-bold mb-8 text-center bg-gradient-to-r from-orange-600 to-red-600 bg-clip-text text-transparent",children:"Choose Your Topic"}),(0,a.jsxs)("div",{className:"jsx-26af8af8a308f6d6 grid grid-cols-3 gap-4 mb-10",children:[(0,a.jsxs)("div",{className:"jsx-26af8af8a308f6d6 bg-white rounded-xl shadow-md p-4 flex flex-col items-center",children:[(0,a.jsx)("div",{className:"jsx-26af8af8a308f6d6 w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center mb-2",children:(0,a.jsx)("span",{className:"jsx-26af8af8a308f6d6 text-xl",children:"\uD83C\uDFAF"})}),(0,a.jsx)("p",{className:"jsx-26af8af8a308f6d6 text-sm text-gray-500",children:"Total Score"}),(0,a.jsx)("p",{className:"jsx-26af8af8a308f6d6 text-2xl font-bold text-orange-600",children:t.totalScore}),(0,a.jsx)("p",{className:"jsx-26af8af8a308f6d6 text-xs text-gray-400",children:"points"})]}),(0,a.jsxs)("div",{className:"jsx-26af8af8a308f6d6 bg-white rounded-xl shadow-md p-4 flex flex-col items-center",children:[(0,a.jsx)("div",{className:"jsx-26af8af8a308f6d6 w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center mb-2",children:(0,a.jsx)("span",{className:"jsx-26af8af8a308f6d6 text-xl",children:"✅"})}),(0,a.jsx)("p",{className:"jsx-26af8af8a308f6d6 text-sm text-gray-500",children:"Completed Tasks"}),(0,a.jsx)("p",{className:"jsx-26af8af8a308f6d6 text-2xl font-bold text-orange-600",children:t.completedTasks}),(0,a.jsx)("p",{className:"jsx-26af8af8a308f6d6 text-xs text-gray-400",children:"activities"})]}),(0,a.jsxs)("div",{className:"jsx-26af8af8a308f6d6 bg-white rounded-xl shadow-md p-4 flex flex-col items-center",children:[(0,a.jsx)("div",{className:"jsx-26af8af8a308f6d6 w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center mb-2",children:(0,a.jsx)("span",{className:"jsx-26af8af8a308f6d6 text-xl",children:"⏱️"})}),(0,a.jsx)("p",{className:"jsx-26af8af8a308f6d6 text-sm text-gray-500",children:"Active Since"}),(0,a.jsx)("p",{className:"jsx-26af8af8a308f6d6 text-2xl font-bold text-orange-600",children:t.activeSince})]})]}),v&&"admin"===v.role&&(0,a.jsx)("div",{className:"jsx-26af8af8a308f6d6 flex justify-center mb-4",children:(0,a.jsxs)(h(),{href:"/dashboard",onClick:e=>{if(console.log("Dashboard link clicked"),!localStorage.getItem("token")){e.preventDefault(),console.error("No token found in localStorage");return}},className:"px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-700 text-white font-semibold rounded-full shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300 flex items-center cursor-pointer",children:[(0,a.jsx)("span",{className:"jsx-26af8af8a308f6d6 mr-2 text-xl",children:"\uD83D\uDCCA"}),(0,a.jsx)("span",{className:"jsx-26af8af8a308f6d6",children:"Dashboard"})]})}),(0,a.jsx)("div",{className:"jsx-26af8af8a308f6d6 flex justify-center mb-8",children:(0,a.jsx)(h(),{href:"/hall-of-fame",children:(0,a.jsxs)("div",{className:"jsx-26af8af8a308f6d6 px-6 py-3 bg-gradient-to-r from-amber-400 to-amber-600 text-white font-semibold rounded-full shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300 flex items-center",children:[(0,a.jsx)("span",{className:"jsx-26af8af8a308f6d6 mr-2 text-xl",children:"\uD83D\uDC51"}),(0,a.jsx)("span",{className:"jsx-26af8af8a308f6d6",children:"Hall of Fame"})]})})}),x&&(0,a.jsx)("div",{className:"jsx-26af8af8a308f6d6 bg-red-100 text-red-700 p-4 rounded-lg mb-6 text-center",children:x}),(0,a.jsx)("div",{className:"jsx-26af8af8a308f6d6 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:e.map(e=>(0,a.jsx)(u,{topic:e,userId:(null==v?void 0:v.UserId)||(null==v?void 0:v.userId)||(null==v?void 0:v.id)||"",onError:b},e.TopicName))})]}),(0,a.jsx)("div",{className:"jsx-26af8af8a308f6d6 absolute top-4 left-4 flex space-x-3",children:(0,a.jsx)("button",{onClick:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),document.cookie="auth_token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT; SameSite=Strict; Secure",N.push("/login")},className:"jsx-26af8af8a308f6d6 w-12 h-12 rounded-full bg-white shadow-lg flex items-center justify-center hover:shadow-xl transform hover:scale-105 transition-all duration-300",children:(0,a.jsx)("span",{className:"jsx-26af8af8a308f6d6 text-2xl",children:"\uD83D\uDC4B"})})})]})):(console.log("\uD83D\uDEAB Topics page: User not authenticated, returning null..."),null)}},38375:(e,s,t)=>{Promise.resolve().then(t.bind(t,21944))},41008:(e,s,t)=>{"use strict";t.d(s,{Av:()=>l,Ly:()=>f,bZ:()=>n,e$:()=>u,kV:()=>c,l6:()=>d,zG:()=>i});let a=t(49509).env.NEXT_PUBLIC_API_URL;async function r(e){let s=e.headers.get("content-type");if(console.log("Response status: ".concat(e.status,", Content-Type: ").concat(s)),s&&s.includes("application/json"))try{let s=await e.json();if(!e.ok){let t={status:e.status,statusText:e.statusText,message:s.message||s.error||"API request failed",responseData:s,url:e.url};throw console.error("API Error (JSON):",t),t}return s}catch(s){if(!e.ok){let t={status:e.status,statusText:e.statusText,message:"Failed to parse JSON response: ".concat(s),responseData:null,url:e.url};throw console.error("API Error (JSON Parse Failed):",t),t}throw s}try{let s=await e.text();if(console.log("Response text (first 200 chars): ".concat(s.substring(0,200))),!e.ok){let t={status:e.status,statusText:e.statusText,message:s||"API request failed",responseData:s,url:e.url};throw console.error("API Error (Text):",t),t}return s}catch(t){let s={status:e.status,statusText:e.statusText,message:"Failed to read response: ".concat(t),responseData:null,url:e.url};throw console.error("API Error (Text Read Failed):",s),s}}async function o(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t={"Content-Type":"application/json",...s.headers},o="".concat(a).concat(e);console.log("Making API call to: ".concat(o));try{let e=await fetch(o,{...s,headers:t,credentials:"include"});return await r(e)}catch(s){throw console.error("API call failed for ".concat(e,":"),{url:o,error:s,errorMessage:s instanceof Error?s.message:"Unknown error",errorStack:s instanceof Error?s.stack:void 0,headers:t}),s&&"object"==typeof s&&(s.endpoint=e,s.fullUrl=o),s}}async function l(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o(e,s)}async function n(){return o("/health")}let i={login:async e=>o("/auth/login",{method:"POST",body:JSON.stringify(e)}),register:async e=>o("/auth/register",{method:"POST",body:JSON.stringify(e)}),validate:async()=>o("/auth/validate",{method:"POST",body:JSON.stringify({})}),logout:async()=>o("/auth/logout",{method:"POST"})},c={getProfile:async()=>o("/user/profile"),updateProfile:async e=>o("/user/profile",{method:"PUT",body:JSON.stringify(e)}),getData:async()=>o("/user/data")},d={getAll:async()=>o("/topics"),getById:async e=>o("/topics/".concat(e)),getUserProgress:async()=>o("/topics/progress")},u={create:async e=>o("/tasks",{method:"POST",body:JSON.stringify(e)}),getById:async e=>o("/tasks/".concat(e)),update:async(e,s)=>o("/tasks/".concat(e),{method:"PUT",body:JSON.stringify(s)}),getUserTasks:async e=>o("/tasks/user/".concat(e))},f={getByTopicAndLevel:async(e,s)=>{try{console.log('\uD83D\uDE80 Fetching flashcards: topic="'.concat(e,'", level="').concat(s,'"'));let t=await o("/flashcards/".concat(encodeURIComponent(e),"/").concat(s));if(t&&t.success)return console.log("✅ Received ".concat(t.data.length," unlearned flashcards")),t.data;if(Array.isArray(t))return console.log("✅ Received ".concat(t.length," unlearned flashcards (direct array)")),t;throw console.error("❌ Unexpected response format:",t),Error("Invalid response format from flashcards API")}catch(e){throw console.error("❌ Error fetching flashcards:",e),e}},create:async e=>o("/flashcards",{method:"POST",body:JSON.stringify(e)}),markAsLearned:async(e,s,t)=>o("/flashcards/mark-learned",{method:"POST",body:JSON.stringify({WordId:e,TaskId:s,TopicName:t})})}},66681:(e,s,t)=>{"use strict";t.d(s,{A:()=>i});var a=t(12115),r=t(41008);let o=[],l={isAuthenticated:!1,isLoading:!0,user:null,error:null,isInitialized:!1},n=e=>{l=e,o.forEach(s=>s(e))},i=()=>{let[e,s]=(0,a.useState)(l);(0,a.useEffect)(()=>{let e=e=>{s(e)};return o.push(e),()=>{o=o.filter(s=>s!==e)}},[]);let t=(0,a.useCallback)(e=>{s(e),n(e)},[]),i=(0,a.useCallback)(async()=>{console.log("\uD83D\uDD0D Starting auth validation...");try{let e=await r.zG.validate();if(console.log("\uD83D\uDCE1 Validation response:",e),!e.valid&&!e.success)return localStorage.removeItem("user"),t({isAuthenticated:!1,isLoading:!1,user:null,error:e.message||"Authentication failed",isInitialized:!0}),!1;{let s=e.user;if(!s||!s.role&&!s.UserRole){let e=localStorage.getItem("user");if(e)try{s={...JSON.parse(e),...s}}catch(e){console.error("Error parsing stored user data:",e)}}return s&&(s={...s,role:s.role||s.UserRole||"user",UserRole:s.UserRole||s.role||"user"}),t({isAuthenticated:!0,isLoading:!1,user:s,error:null,isInitialized:!0}),!0}}catch(s){console.error("Auth validation error:",s);let e=localStorage.getItem("user");if(e)try{let s=JSON.parse(e);return t({isAuthenticated:!0,isLoading:!1,user:s,error:null,isInitialized:!0}),!0}catch(e){console.error("Error parsing stored user data:",e)}return localStorage.removeItem("user"),t({isAuthenticated:!1,isLoading:!1,user:null,error:s instanceof Error?s.message:"Authentication error",isInitialized:!0}),!1}},[t]);(0,a.useEffect)(()=>{i()},[i]);let c=async function(s,a){arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{console.log("\uD83D\uDD10 Starting login process..."),t({...e,isLoading:!0});let o=await r.zG.login({email:s,password:a});if(console.log("\uD83D\uDCE1 Login response:",o),!o.success)return t({isAuthenticated:!1,isLoading:!1,user:null,error:o.message||"Login failed",isInitialized:!0}),{success:!1,message:o.message||"Login failed"};{let e=o.user||{email:s},a={...e,role:(null==e?void 0:e.role)||(null==e?void 0:e.UserRole)||"user",UserRole:(null==e?void 0:e.UserRole)||(null==e?void 0:e.role)||"user"};return localStorage.setItem("user",JSON.stringify(a)),t({isAuthenticated:!0,isLoading:!1,user:a,error:null,isInitialized:!0}),{success:!0}}}catch(s){if(console.error("❌ Login error:",s),s.responseData){let e=s.responseData.message||s.message||"Login failed";return console.log("API Error details:",s.responseData),t({isAuthenticated:!1,isLoading:!1,user:null,error:e,isInitialized:!0}),{success:!1,message:e,details:s.responseData.details}}let e=s instanceof Error?s.message:"An unexpected error occurred";return t({isAuthenticated:!1,isLoading:!1,user:null,error:e,isInitialized:!0}),{success:!1,message:e}}},d=async()=>{console.log("\uD83D\uDC4B Logging out...");try{await r.zG.logout()}catch(e){console.error("Logout API call failed:",e)}localStorage.removeItem("user"),t({isAuthenticated:!1,isLoading:!1,user:null,error:null,isInitialized:!0})};return{...e,login:c,logout:d,validateAuth:i}}}},e=>{var s=s=>e(e.s=s);e.O(0,[6874,9443,8441,1684,7358],()=>s(38375)),_N_E=e.O()}]);