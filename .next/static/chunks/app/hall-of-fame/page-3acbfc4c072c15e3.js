(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8786],{17638:(e,t,s)=>{Promise.resolve().then(s.bind(s,95180))},41008:(e,t,s)=>{"use strict";s.d(t,{Av:()=>o,Ly:()=>u,bZ:()=>n,e$:()=>f,kV:()=>c,l6:()=>d,zG:()=>i});let a=s(49509).env.NEXT_PUBLIC_API_URL;async function r(e){let t=e.headers.get("content-type");if(console.log("Response status: ".concat(e.status,", Content-Type: ").concat(t)),t&&t.includes("application/json"))try{let t=await e.json();if(!e.ok){let s={status:e.status,statusText:e.statusText,message:t.message||t.error||"API request failed",responseData:t,url:e.url};throw console.error("API Error (JSON):",s),s}return t}catch(t){if(!e.ok){let s={status:e.status,statusText:e.statusText,message:"Failed to parse JSON response: ".concat(t),responseData:null,url:e.url};throw console.error("API Error (JSON Parse Failed):",s),s}throw t}try{let t=await e.text();if(console.log("Response text (first 200 chars): ".concat(t.substring(0,200))),!e.ok){let s={status:e.status,statusText:e.statusText,message:t||"API request failed",responseData:t,url:e.url};throw console.error("API Error (Text):",s),s}return t}catch(s){let t={status:e.status,statusText:e.statusText,message:"Failed to read response: ".concat(s),responseData:null,url:e.url};throw console.error("API Error (Text Read Failed):",t),t}}async function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s={"Content-Type":"application/json",...t.headers},l="".concat(a).concat(e);console.log("Making API call to: ".concat(l));try{let e=await fetch(l,{...t,headers:s,credentials:"include"});return await r(e)}catch(t){throw console.error("API call failed for ".concat(e,":"),{url:l,error:t,errorMessage:t instanceof Error?t.message:"Unknown error",errorStack:t instanceof Error?t.stack:void 0,headers:s}),t&&"object"==typeof t&&(t.endpoint=e,t.fullUrl=l),t}}async function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return l(e,t)}async function n(){return l("/health")}let i={login:async e=>l("/auth/login",{method:"POST",body:JSON.stringify(e)}),register:async e=>l("/auth/register",{method:"POST",body:JSON.stringify(e)}),validate:async()=>l("/auth/validate",{method:"POST",body:JSON.stringify({})}),logout:async()=>l("/auth/logout",{method:"POST"})},c={getProfile:async()=>l("/user/profile"),updateProfile:async e=>l("/user/profile",{method:"PUT",body:JSON.stringify(e)}),getData:async()=>l("/user/data")},d={getAll:async()=>l("/topics"),getById:async e=>l("/topics/".concat(e)),getUserProgress:async()=>l("/topics/progress")},f={create:async e=>l("/tasks",{method:"POST",body:JSON.stringify(e)}),getById:async e=>l("/tasks/".concat(e)),update:async(e,t)=>l("/tasks/".concat(e),{method:"PUT",body:JSON.stringify(t)}),getUserTasks:async e=>l("/tasks/user/".concat(e))},u={getByTopicAndLevel:async(e,t)=>{try{console.log('\uD83D\uDE80 Fetching flashcards: topic="'.concat(e,'", level="').concat(t,'"'));let s=await l("/flashcards/".concat(encodeURIComponent(e),"/").concat(t));if(s&&s.success)return console.log("✅ Received ".concat(s.data.length," unlearned flashcards")),s.data;if(Array.isArray(s))return console.log("✅ Received ".concat(s.length," unlearned flashcards (direct array)")),s;throw console.error("❌ Unexpected response format:",s),Error("Invalid response format from flashcards API")}catch(e){throw console.error("❌ Error fetching flashcards:",e),e}},create:async e=>l("/flashcards",{method:"POST",body:JSON.stringify(e)}),markAsLearned:async(e,t,s)=>l("/flashcards/mark-learned",{method:"POST",body:JSON.stringify({WordId:e,TaskId:t,TopicName:s})})}},66681:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var a=s(12115),r=s(41008);let l=[],o={isAuthenticated:!1,isLoading:!0,user:null,error:null,isInitialized:!1},n=e=>{o=e,l.forEach(t=>t(e))},i=()=>{let[e,t]=(0,a.useState)(o);(0,a.useEffect)(()=>{let e=e=>{t(e)};return l.push(e),()=>{l=l.filter(t=>t!==e)}},[]);let s=(0,a.useCallback)(e=>{t(e),n(e)},[]),i=(0,a.useCallback)(async()=>{console.log("\uD83D\uDD0D Starting auth validation...");try{let e=await r.zG.validate();if(console.log("\uD83D\uDCE1 Validation response:",e),!e.valid&&!e.success)return localStorage.removeItem("user"),s({isAuthenticated:!1,isLoading:!1,user:null,error:e.message||"Authentication failed",isInitialized:!0}),!1;{let t=e.user;if(!t||!t.role&&!t.UserRole){let e=localStorage.getItem("user");if(e)try{t={...JSON.parse(e),...t}}catch(e){console.error("Error parsing stored user data:",e)}}return t&&(t={...t,role:t.role||t.UserRole||"user",UserRole:t.UserRole||t.role||"user"}),s({isAuthenticated:!0,isLoading:!1,user:t,error:null,isInitialized:!0}),!0}}catch(t){console.error("Auth validation error:",t);let e=localStorage.getItem("user");if(e)try{let t=JSON.parse(e);return s({isAuthenticated:!0,isLoading:!1,user:t,error:null,isInitialized:!0}),!0}catch(e){console.error("Error parsing stored user data:",e)}return localStorage.removeItem("user"),s({isAuthenticated:!1,isLoading:!1,user:null,error:t instanceof Error?t.message:"Authentication error",isInitialized:!0}),!1}},[s]);(0,a.useEffect)(()=>{i()},[i]);let c=async function(t,a){arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{console.log("\uD83D\uDD10 Starting login process..."),s({...e,isLoading:!0});let l=await r.zG.login({email:t,password:a});if(console.log("\uD83D\uDCE1 Login response:",l),!l.success)return s({isAuthenticated:!1,isLoading:!1,user:null,error:l.message||"Login failed",isInitialized:!0}),{success:!1,message:l.message||"Login failed"};{let e=l.user||{email:t},a={...e,role:(null==e?void 0:e.role)||(null==e?void 0:e.UserRole)||"user",UserRole:(null==e?void 0:e.UserRole)||(null==e?void 0:e.role)||"user"};return localStorage.setItem("user",JSON.stringify(a)),s({isAuthenticated:!0,isLoading:!1,user:a,error:null,isInitialized:!0}),{success:!0}}}catch(t){if(console.error("❌ Login error:",t),t.responseData){let e=t.responseData.message||t.message||"Login failed";return console.log("API Error details:",t.responseData),s({isAuthenticated:!1,isLoading:!1,user:null,error:e,isInitialized:!0}),{success:!1,message:e,details:t.responseData.details}}let e=t instanceof Error?t.message:"An unexpected error occurred";return s({isAuthenticated:!1,isLoading:!1,user:null,error:e,isInitialized:!0}),{success:!1,message:e}}},d=async()=>{console.log("\uD83D\uDC4B Logging out...");try{await r.zG.logout()}catch(e){console.error("Logout API call failed:",e)}localStorage.removeItem("user"),s({isAuthenticated:!1,isLoading:!1,user:null,error:null,isInitialized:!0})};return{...e,login:c,logout:d,validateAuth:i}}},95180:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var a=s(95155),r=s(11518),l=s.n(r),o=s(12115),n=s(35695),i=s(66681),c=s(6874),d=s.n(c),f=s(66766);function u(){let[e,t]=(0,o.useState)([]),[s,r]=(0,o.useState)(!0),[c,u]=(0,o.useState)(null),{isAuthenticated:x,isLoading:h}=(0,i.A)(),m=(0,n.useRouter)();return((0,o.useEffect)(()=>{let e=async()=>{try{r(!0);let e=await fetch("/api/top-users",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(!e.ok)throw Error("Failed to fetch top users");let s=await e.json();console.log("Top users data:",s),t(s),r(!1)}catch(e){console.error("Error fetching top users:",e),u("Failed to load the Hall of Fame. Please try again later."),r(!1)}};x&&e()},[x]),(0,o.useEffect)(()=>{h||x||m.push("/login")},[x,h,m]),h||s)?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-yellow-50 via-orange-50 to-red-50",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-orange-500"})}):(0,a.jsxs)("div",{className:"jsx-26af8af8a308f6d6 min-h-screen bg-gradient-to-br from-yellow-50 via-orange-50 to-red-50 p-6",children:[(0,a.jsx)(l(),{id:"26af8af8a308f6d6",children:'@import url("https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap");body{font-family:"Poppins",sans-serif}'}),(0,a.jsxs)("div",{className:"jsx-26af8af8a308f6d6 max-w-4xl mx-auto",children:[(0,a.jsxs)("div",{className:"jsx-26af8af8a308f6d6 text-center mb-12",children:[(0,a.jsx)("h1",{className:"jsx-26af8af8a308f6d6 text-5xl font-bold mb-4 bg-gradient-to-r from-orange-600 to-red-600 bg-clip-text text-transparent",children:"Hall of Fame"}),(0,a.jsx)("p",{className:"jsx-26af8af8a308f6d6 text-lg text-gray-600",children:"Our top learners with the highest scores"})]}),c&&(0,a.jsx)("div",{className:"jsx-26af8af8a308f6d6 bg-red-100 text-red-700 p-4 rounded-lg mb-6 text-center",children:c}),e.length>0&&(0,a.jsxs)("div",{className:"jsx-26af8af8a308f6d6 flex justify-center items-end mb-16 h-64 px-4",children:[e.length>=2&&(0,a.jsxs)("div",{className:"jsx-26af8af8a308f6d6 mx-4 flex flex-col items-center",children:[(0,a.jsxs)("div",{className:"jsx-26af8af8a308f6d6 relative",children:[e[1].ProfilePicture?(0,a.jsx)(f.default,{src:e[1].ProfilePicture,alt:"".concat(e[1].FirstName," ").concat(e[1].LastName),width:64,height:64,className:"w-16 h-16 rounded-full object-cover border-4 border-gray-300"}):(0,a.jsx)("div",{className:"jsx-26af8af8a308f6d6 w-16 h-16 rounded-full bg-gray-300 flex items-center justify-center text-2xl",children:e[1].FirstName.charAt(0)}),(0,a.jsx)("div",{className:"jsx-26af8af8a308f6d6 absolute -top-5 -right-2 bg-gray-300 w-8 h-8 rounded-full flex items-center justify-center text-white font-bold",children:"2"})]}),(0,a.jsxs)("div",{className:"jsx-26af8af8a308f6d6 h-32 w-24 bg-gray-300 rounded-t-lg mt-4 flex flex-col items-center justify-center p-2",children:[(0,a.jsxs)("p",{className:"jsx-26af8af8a308f6d6 font-semibold text-center text-sm truncate w-full",children:[e[1].FirstName," ",e[1].LastName]}),(0,a.jsx)("p",{className:"jsx-26af8af8a308f6d6 text-lg font-bold text-gray-700",children:e[1].Score})]})]}),e.length>=1&&(0,a.jsxs)("div",{className:"jsx-26af8af8a308f6d6 mx-4 flex flex-col items-center",children:[(0,a.jsxs)("div",{className:"jsx-26af8af8a308f6d6 relative",children:[e[0].ProfilePicture?(0,a.jsx)(f.default,{src:e[0].ProfilePicture,alt:"".concat(e[0].FirstName," ").concat(e[0].LastName),width:80,height:80,className:"w-20 h-20 rounded-full object-cover border-4 border-yellow-400"}):(0,a.jsx)("div",{className:"jsx-26af8af8a308f6d6 w-20 h-20 rounded-full bg-yellow-400 flex items-center justify-center text-3xl",children:e[0].FirstName.charAt(0)}),(0,a.jsx)("div",{className:"jsx-26af8af8a308f6d6 absolute -top-5 -right-2 bg-yellow-500 w-8 h-8 rounded-full flex items-center justify-center text-white font-bold",children:"1"})]}),(0,a.jsxs)("div",{className:"jsx-26af8af8a308f6d6 h-48 w-32 bg-yellow-400 rounded-t-lg mt-4 flex flex-col items-center justify-center p-2",children:[(0,a.jsxs)("p",{className:"jsx-26af8af8a308f6d6 font-semibold text-center text-lg truncate w-full",children:[e[0].FirstName," ",e[0].LastName]}),(0,a.jsx)("p",{className:"jsx-26af8af8a308f6d6 text-2xl font-bold text-yellow-800",children:e[0].Score}),(0,a.jsx)("div",{className:"jsx-26af8af8a308f6d6 mt-2",children:(0,a.jsx)("span",{className:"jsx-26af8af8a308f6d6 text-4xl",children:"\uD83D\uDC51"})})]})]}),e.length>=3&&(0,a.jsxs)("div",{className:"jsx-26af8af8a308f6d6 mx-4 flex flex-col items-center",children:[(0,a.jsxs)("div",{className:"jsx-26af8af8a308f6d6 relative",children:[e[2].ProfilePicture?(0,a.jsx)(f.default,{src:e[2].ProfilePicture,alt:"".concat(e[2].FirstName," ").concat(e[2].LastName),width:56,height:56,className:"w-14 h-14 rounded-full object-cover border-4 border-amber-700"}):(0,a.jsx)("div",{className:"jsx-26af8af8a308f6d6 w-14 h-14 rounded-full bg-amber-700 flex items-center justify-center text-xl",children:e[2].FirstName.charAt(0)}),(0,a.jsx)("div",{className:"jsx-26af8af8a308f6d6 absolute -top-5 -right-2 bg-amber-700 w-8 h-8 rounded-full flex items-center justify-center text-white font-bold",children:"3"})]}),(0,a.jsxs)("div",{className:"jsx-26af8af8a308f6d6 h-24 w-20 bg-amber-700 rounded-t-lg mt-4 flex flex-col items-center justify-center p-2",children:[(0,a.jsxs)("p",{className:"jsx-26af8af8a308f6d6 font-semibold text-center text-xs truncate w-full text-white",children:[e[2].FirstName," ",e[2].LastName]}),(0,a.jsx)("p",{className:"jsx-26af8af8a308f6d6 text-base font-bold text-amber-200",children:e[2].Score})]})]})]}),e.length>3&&(0,a.jsx)("div",{className:"jsx-26af8af8a308f6d6 bg-white rounded-xl shadow-lg overflow-hidden mb-8",children:(0,a.jsxs)("table",{className:"jsx-26af8af8a308f6d6 w-full",children:[(0,a.jsx)("thead",{className:"jsx-26af8af8a308f6d6 bg-orange-100",children:(0,a.jsxs)("tr",{className:"jsx-26af8af8a308f6d6",children:[(0,a.jsx)("th",{className:"jsx-26af8af8a308f6d6 py-3 px-4 text-left text-sm font-semibold text-gray-700",children:"Rank"}),(0,a.jsx)("th",{className:"jsx-26af8af8a308f6d6 py-3 px-4 text-left text-sm font-semibold text-gray-700",children:"User"}),(0,a.jsx)("th",{className:"jsx-26af8af8a308f6d6 py-3 px-4 text-right text-sm font-semibold text-gray-700",children:"Score"})]})}),(0,a.jsx)("tbody",{className:"jsx-26af8af8a308f6d6",children:e.slice(3).map(e=>(0,a.jsxs)("tr",{className:"jsx-26af8af8a308f6d6 border-t border-gray-200",children:[(0,a.jsx)("td",{className:"jsx-26af8af8a308f6d6 py-4 px-4 flex items-center",children:(0,a.jsxs)("span",{className:"jsx-26af8af8a308f6d6 bg-gray-200 w-8 h-8 rounded-full flex items-center justify-center font-bold text-gray-700",children:[e.UserRank," "]})}),(0,a.jsx)("td",{className:"jsx-26af8af8a308f6d6 py-4 px-4",children:(0,a.jsxs)("div",{className:"jsx-26af8af8a308f6d6 flex items-center",children:[e.ProfilePicture?(0,a.jsx)(f.default,{src:e.ProfilePicture,alt:"".concat(e.FirstName," ").concat(e.LastName),width:40,height:40,className:"w-10 h-10 rounded-full object-cover mr-3"}):(0,a.jsx)("div",{className:"jsx-26af8af8a308f6d6 w-10 h-10 rounded-full bg-gray-300 flex items-center justify-center mr-3",children:e.FirstName.charAt(0)}),(0,a.jsxs)("span",{className:"jsx-26af8af8a308f6d6 font-medium",children:[e.FirstName," ",e.LastName]})]})}),(0,a.jsx)("td",{className:"jsx-26af8af8a308f6d6 py-4 px-4 text-right font-bold text-gray-800",children:e.Score})]},e.UserId))})]})}),(0,a.jsx)("div",{className:"jsx-26af8af8a308f6d6 mt-8 flex justify-center gap-4",children:(0,a.jsx)(d(),{href:"/topics",className:"px-6 py-3 bg-white rounded-full shadow-md hover:shadow-lg transition-all duration-300 text-orange-600 font-medium",children:"Back to Topics"})})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[6874,9443,8441,1684,7358],()=>t(17638)),_N_E=e.O()}]);